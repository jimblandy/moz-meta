#!/usr/bin/env bash

set -eux

WGPU=/home/jimb/rust/wgpu

cargo fmt
cargo clippy --workspace -- -D warnings
WGPU_BACKEND=vulkan                             \
    cargo nextest run                           \
    --workspace                                 \
    --exclude cts_runner

CARGO_TARGET_DIR=$WGPU/jimb-wasm-target \
    RUSTFLAGS=--cfg=web_sys_unstable_apis \
    cargo clippy \
    --target wasm32-unknown-unknown

cargo doc -p wgpu-core --document-private-items
